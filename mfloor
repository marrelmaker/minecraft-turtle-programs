local function placeAndSwitch()
  if turtle.detectDown() then
    turtle.digDown()
  end
  turtle.placeDown()
  totalItems = totalItems - 1

  if totalItems <= 0 then
    return 1
  end

  if (turtle.getItemCount() <= 0) or (turtle.getItemDetail().name ~= itemID) then
    turtle.select(turtle.getSelectedSlot()+1)
  end
end

local function doLine(length, placefirst)
  if length < 1 then
    turtle.turnRight()
	return 1
  end
  
  for i=1,length do
    if placefirst or (i > 1) then
      placeAndSwitch()
	end
	
	if i < length then
	  turtle.forward()
	end
  end
  
  turtle.turnRight()
end

turtle.select(1)
if turtle.getItemDetail().name == nil
  print("Target Item missing")
  return 1
end

print("Foreward (x for detect): ")
local fw = tonumber(read())
print("Right (x for detect): ")
local rght = tonumber(read())

turtle.select(16)
turtle.refuel()
turtle.select(1)

itemID = turtle.getItemDetail().name
totalItems = 0

for i=1,15 do
  turtle.select(i)
  if (turtle.getItemCount() > 0 ) and (itemID == turtle.getItemDetail().name) then
    totalItems = totalItems + turtle.getItemCount()
  end
end
turtle.select(1)

if fw*rght > totalItems then
  print("Not enough Items")
  return
end

local xxx = 0
if fw < rght then
  xxx = fw
else 
  xxx = rght
end

for n=0,xxx do
  doLine(fw-(n*2), true)
  doLine(rght-(n*2), false)
  doLine(fw-(n*2), false)
  if doLine(rght-(n*2)-1, false) == 1 then
    return
  end
  turtle.forward()
end






